import { HttpParams } from '@angular/common/http';
import { ChangeDetectionStrategy, Component, Input } from '@angular/core';
import { Validators } from '@angular/forms';
import { map } from 'rxjs/operators';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common/http";
import * as i2 from "@angular/forms";
import * as i3 from "@mapp-ui/notification-center";
import * as i4 from "@angular/common";
import * as i5 from "@angular/material/button";
import * as i6 from "@angular/material/input";
import * as i7 from "@angular/material/form-field";
import * as i8 from "@angular/material/slide-toggle";
import * as i9 from "@angular/material/select";
import * as i10 from "@angular/material/core";
export class EditProfileComponent {
    constructor(http, fb, cd, nc) {
        this.http = http;
        this.fb = fb;
        this.cd = cd;
        this.nc = nc;
        this.displayMfaSetting = false;
    }
    ngOnInit() {
        this.createForm();
        if (this.profileDataUrl) {
            this.http.get(this.profileDataUrl)
                .subscribe(res => {
                this.profileData = res;
                this.form.reset({
                    email: this.profileData['systemUser.Email'],
                    role: this.profileData['systemUser.CustomerRole'],
                    timeZone: this.profileData['systemUser.TimeZone'],
                    locale: this.profileData['systemUser.Locale'],
                    type: this.profileData['systemUser.Type'],
                    communication: this.profileData['systemUser.EmergencyCommunication'] === 'true',
                    firstName: this.profileData['systemUser.FirstName'],
                    lastName: this.profileData['systemUser.LastName'],
                    mfaEnabled: this.profileData['systemUser.MFA'] === 'true'
                });
                this.displayMfaSetting = this.profileData['systemUser.CanViewMFA'] === 'true';
                this.cd.markForCheck();
            });
        }
        if (this.languageDataUrl) {
            this.languages$ = this.http.get(this.languageDataUrl)
                .pipe(map(res => res.languagewithcountryseq));
        }
        if (this.timeZoneDataUrl) {
            this.timeZones$ = this.http.get(this.timeZoneDataUrl)
                .pipe(map(res => res.timezones));
        }
    }
    saveUserProfile() {
        if (this.form.invalid) {
            return;
        }
        const formData = this.form.value;
        const rawBody = {
            'systemUser.Email': this.profileData['systemUser.Email'],
            'systemUser.PK': this.profileData['systemUser.PK'],
            'systemUser.Type': this.profileData['systemUser.Type'],
            'systemUser.CustomerRole': this.profileData['systemUser.CustomerRole'],
            'systemUser.Locale': formData.locale,
            'systemUser.TimeZone': formData.timeZone,
            'systemUser.FirstName': formData.firstName,
            'systemUser.LastName': formData.lastName,
            'systemUser_emergencyCommunication': formData.communication ? 'on' : 'off',
            action: 'saveSystemUser',
            errorPage: '/inc/ecError.jsp'
        };
        if (this.displayMfaSetting) {
            rawBody['systemUser_mfaAdminRole'] = formData.mfaEnabled ? 'on' : 'off';
        }
        const body = new HttpParams({ fromObject: rawBody });
        const responseHandler = (res) => {
            if (res.indexOf('ec-errors') > -1) {
                this.nc.addNotification({
                    type: 'ERROR',
                    message: {
                        headline: 'Profile update failed.',
                        body: res,
                        htmlContent: true
                    }
                });
            }
            else {
                this.nc.addNotification({
                    type: 'SUCCESS',
                    message: {
                        headline: 'Profile updated.'
                    }
                });
            }
        };
        if (this.profileSaveUrl) {
            this.http.post(this.profileSaveUrl, body, { responseType: 'text' })
                .subscribe({
                next: responseHandler,
                error: (err) => {
                    console.error('Unexpected error saving user profile', err);
                }
            });
        }
    }
    createForm() {
        this.form = this.fb.group({
            email: [{ value: '', disabled: true }],
            role: [{ value: 'administrator', disabled: true }],
            timeZone: '',
            locale: '',
            type: [{ value: 'h', disabled: true }],
            communication: false,
            firstName: ['', Validators.required],
            lastName: ['', Validators.required],
            mfaEnabled: false
        });
    }
}
EditProfileComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.2.10", ngImport: i0, type: EditProfileComponent, deps: [{ token: i1.HttpClient }, { token: i2.UntypedFormBuilder }, { token: i0.ChangeDetectorRef }, { token: i3.NotificationService }], target: i0.ɵɵFactoryTarget.Component });
EditProfileComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "15.2.10", type: EditProfileComponent, selector: "mui-edit-profile", inputs: { profileDataUrl: "profileDataUrl", languageDataUrl: "languageDataUrl", timeZoneDataUrl: "timeZoneDataUrl", profileSaveUrl: "profileSaveUrl" }, ngImport: i0, template: "<section *ngIf=\"profileData\"\r\n    class=\"form-container\">\r\n  <form [formGroup]=\"form\">\r\n    <div class=\"form-row\">\r\n      <mat-form-field appearance=\"outline\">\r\n        <mat-label i18n=\"@@topnav_editprofile_accounttype\">Type</mat-label>\r\n        <mat-select formControlName=\"type\">\r\n          <mat-option value=\"u\"\r\n              i18n=\"@@topnav_editprofile_uiuser\">\r\n            UI User\r\n          </mat-option>\r\n          <mat-option value=\"a\"\r\n              i18n=\"@@topnav_editprofile_apiuser\">\r\n            API User\r\n          </mat-option>\r\n          <mat-option value=\"h\"\r\n              i18n=\"@@topnav_editprofile_hybriduser\">\r\n            Hybrid User\r\n          </mat-option>\r\n        </mat-select>\r\n      </mat-form-field>\r\n      <mat-form-field appearance=\"outline\">\r\n        <mat-label i18n=\"@@topnav_editprofile_role\">Role</mat-label>\r\n        <mat-select formControlName=\"role\">\r\n          <mat-option value=\"administrator\"\r\n              i18n=\"@@topnav_editprofile_admin\">\r\n            Administrator\r\n          </mat-option>\r\n          <mat-option value=\"project_manager\"\r\n              i18n=\"@@topnav_editprofile_pm\">\r\n            Project Manager\r\n          </mat-option>\r\n          <mat-option value=\"client_admin\"\r\n              i18n=\"@@topnav_editprofile_clientadmin\">\r\n            Client Administrator\r\n          </mat-option>\r\n          <mat-option value=\"super_user\"\r\n              i18n=\"@@topnav_editprofile_superuser\">\r\n            Superuser\r\n          </mat-option>\r\n          <mat-option value=\"user\"\r\n              i18n=\"@@topnav_editprofile_normaluser\">\r\n            Normal User\r\n          </mat-option>\r\n          <mat-option value=\"cust_user1\">\r\n            <span i18n=\"@@topnav_editprofile_customuser\">Custom User</span> 1\r\n          </mat-option>\r\n          <mat-option value=\"cust_user2\">\r\n            <span i18n=\"@@topnav_editprofile_customuser\">Custom User</span> 2\r\n          </mat-option>\r\n          <mat-option value=\"cust_user3\">\r\n            <span i18n=\"@@topnav_editprofile_customuser\">Custom User</span> 3\r\n          </mat-option>\r\n          <mat-option value=\"cust_user4\">\r\n            <span i18n=\"@@topnav_editprofile_customuser\">Custom User</span> 4\r\n          </mat-option>\r\n          <mat-option value=\"cust_user5\">\r\n            <span i18n=\"@@topnav_editprofile_customuser\">Custom User</span> 5\r\n          </mat-option>\r\n          <mat-option value=\"cust_user6\">\r\n            <span i18n=\"@@topnav_editprofile_customuser\">Custom User</span> 6\r\n          </mat-option>\r\n          <mat-option value=\"cust_user7\">\r\n            <span i18n=\"@@topnav_editprofile_customuser\">Custom User</span> 7\r\n          </mat-option>\r\n          <mat-option value=\"cust_user8\">\r\n            <span i18n=\"@@topnav_editprofile_customuser\">Custom User</span> 8\r\n          </mat-option>\r\n          <mat-option value=\"none_role\"\r\n              i18n=\"@@topnav_editprofile_role_none\">\r\n            None\r\n          </mat-option>\r\n        </mat-select>\r\n      </mat-form-field>\r\n\r\n    </div>\r\n    <div class=\"form-row\">\r\n      <mat-form-field appearance=\"outline\"\r\n          class=\"email\">\r\n        <mat-label i18n=\"@@topnav_editprofile_email\">Email</mat-label>\r\n        <input formControlName=\"email\"\r\n            matInput\r\n            type=\"email\"\r\n        >\r\n      </mat-form-field>\r\n    </div>\r\n    <div class=\"form-row\">\r\n      <mat-form-field appearance=\"outline\">\r\n        <mat-label i18n=\"@@topnav_editprofile_firstname\">First Name</mat-label>\r\n        <input formControlName=\"firstName\"\r\n            matInput\r\n            required>\r\n        <mat-error i18n=\"@@topnav_field_required\">This field is required</mat-error>\r\n      </mat-form-field>\r\n\r\n      <mat-form-field appearance=\"outline\">\r\n        <mat-label i18n=\"@@topnav_editprofile_lastname\">Last Name</mat-label>\r\n        <input formControlName=\"lastName\"\r\n            matInput\r\n            required>\r\n        <mat-error i18n=\"@@topnav_field_required\">This field is required</mat-error>\r\n      </mat-form-field>\r\n    </div>\r\n    <div class=\"form-row\">\r\n      <mat-form-field appearance=\"outline\">\r\n        <mat-label i18n=\"@@topnav_editprofile_language\">Language</mat-label>\r\n        <mat-select formControlName=\"locale\">\r\n          <mat-option *ngFor=\"let lang of languages$ | async\"\r\n              [value]=\"lang.id\">{{ lang.name }}</mat-option>\r\n        </mat-select>\r\n      </mat-form-field>\r\n\r\n      <mat-form-field appearance=\"outline\">\r\n        <mat-label i18n=\"@@topnav_editprofile_timezone\">Time Zone</mat-label>\r\n        <mat-select formControlName=\"timeZone\">\r\n          <mat-option *ngFor=\"let zone of timeZones$ | async\"\r\n              [value]=\"zone.id\">{{ zone.name }}</mat-option>\r\n        </mat-select>\r\n      </mat-form-field>\r\n    </div>\r\n    <div class=\"form-row toggle\">\r\n      <mat-slide-toggle formControlName=\"communication\"\r\n          labelPosition=\"after\"\r\n          i18n=\"@@topnav_editprofile_receive_emergency\">Receive emergency\r\n        communication\r\n      </mat-slide-toggle>\r\n    </div>\r\n    <div class=\"form-row toggle\"\r\n        *ngIf=\"displayMfaSetting\">\r\n      <mat-slide-toggle formControlName=\"mfaEnabled\"\r\n          labelPosition=\"after\"\r\n          i18n=\"@@topnav_editprofile_mfa\">Enable MFA for admin role\r\n      </mat-slide-toggle>\r\n    </div>\r\n    <div class=\"actions\">\r\n      <button (click)=\"saveUserProfile()\"\r\n          color=\"primary\"\r\n          mat-flat-button\r\n          type=\"button\"\r\n          i18n=\"@@topnav_savebtn\"\r\n      >Save\r\n      </button>\r\n    </div>\r\n  </form>\r\n</section>\r\n", styles: [".actions{margin-top:14px;text-align:right}.form-container{padding:14px 0;font-size:14px}.form-row{display:flex;flex-direction:row;justify-content:space-between;margin-bottom:5px}.form-row>.mat-mdc-form-field{width:47%}.form-row>.mat-mdc-form-field.email{width:100%}.toggle{margin-bottom:24px;padding-left:14px}\n"], dependencies: [{ kind: "directive", type: i4.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { kind: "directive", type: i4.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "component", type: i5.MatButton, selector: "    button[mat-button], button[mat-raised-button], button[mat-flat-button],    button[mat-stroked-button]  ", inputs: ["disabled", "disableRipple", "color"], exportAs: ["matButton"] }, { kind: "directive", type: i6.MatInput, selector: "input[matInput], textarea[matInput], select[matNativeControl],      input[matNativeControl], textarea[matNativeControl]", inputs: ["disabled", "id", "placeholder", "name", "required", "type", "errorStateMatcher", "aria-describedby", "value", "readonly"], exportAs: ["matInput"] }, { kind: "component", type: i7.MatFormField, selector: "mat-form-field", inputs: ["hideRequiredMarker", "color", "floatLabel", "appearance", "subscriptSizing", "hintLabel"], exportAs: ["matFormField"] }, { kind: "directive", type: i7.MatLabel, selector: "mat-label" }, { kind: "directive", type: i7.MatError, selector: "mat-error, [matError]", inputs: ["id"] }, { kind: "component", type: i8.MatSlideToggle, selector: "mat-slide-toggle", inputs: ["disabled", "disableRipple", "color", "tabIndex"], exportAs: ["matSlideToggle"] }, { kind: "component", type: i9.MatSelect, selector: "mat-select", inputs: ["disabled", "disableRipple", "tabIndex", "hideSingleSelectionIndicator"], exportAs: ["matSelect"] }, { kind: "component", type: i10.MatOption, selector: "mat-option", exportAs: ["matOption"] }, { kind: "directive", type: i2.ɵNgNoValidate, selector: "form:not([ngNoForm]):not([ngNativeValidate])" }, { kind: "directive", type: i2.DefaultValueAccessor, selector: "input:not([type=checkbox])[formControlName],textarea[formControlName],input:not([type=checkbox])[formControl],textarea[formControl],input:not([type=checkbox])[ngModel],textarea[ngModel],[ngDefaultControl]" }, { kind: "directive", type: i2.NgControlStatus, selector: "[formControlName],[ngModel],[formControl]" }, { kind: "directive", type: i2.NgControlStatusGroup, selector: "[formGroupName],[formArrayName],[ngModelGroup],[formGroup],form:not([ngNoForm]),[ngForm]" }, { kind: "directive", type: i2.RequiredValidator, selector: ":not([type=checkbox])[required][formControlName],:not([type=checkbox])[required][formControl],:not([type=checkbox])[required][ngModel]", inputs: ["required"] }, { kind: "directive", type: i2.FormGroupDirective, selector: "[formGroup]", inputs: ["formGroup"], outputs: ["ngSubmit"], exportAs: ["ngForm"] }, { kind: "directive", type: i2.FormControlName, selector: "[formControlName]", inputs: ["formControlName", "disabled", "ngModel"], outputs: ["ngModelChange"] }, { kind: "pipe", type: i4.AsyncPipe, name: "async" }], changeDetection: i0.ChangeDetectionStrategy.OnPush });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.2.10", ngImport: i0, type: EditProfileComponent, decorators: [{
            type: Component,
            args: [{ selector: 'mui-edit-profile', changeDetection: ChangeDetectionStrategy.OnPush, template: "<section *ngIf=\"profileData\"\r\n    class=\"form-container\">\r\n  <form [formGroup]=\"form\">\r\n    <div class=\"form-row\">\r\n      <mat-form-field appearance=\"outline\">\r\n        <mat-label i18n=\"@@topnav_editprofile_accounttype\">Type</mat-label>\r\n        <mat-select formControlName=\"type\">\r\n          <mat-option value=\"u\"\r\n              i18n=\"@@topnav_editprofile_uiuser\">\r\n            UI User\r\n          </mat-option>\r\n          <mat-option value=\"a\"\r\n              i18n=\"@@topnav_editprofile_apiuser\">\r\n            API User\r\n          </mat-option>\r\n          <mat-option value=\"h\"\r\n              i18n=\"@@topnav_editprofile_hybriduser\">\r\n            Hybrid User\r\n          </mat-option>\r\n        </mat-select>\r\n      </mat-form-field>\r\n      <mat-form-field appearance=\"outline\">\r\n        <mat-label i18n=\"@@topnav_editprofile_role\">Role</mat-label>\r\n        <mat-select formControlName=\"role\">\r\n          <mat-option value=\"administrator\"\r\n              i18n=\"@@topnav_editprofile_admin\">\r\n            Administrator\r\n          </mat-option>\r\n          <mat-option value=\"project_manager\"\r\n              i18n=\"@@topnav_editprofile_pm\">\r\n            Project Manager\r\n          </mat-option>\r\n          <mat-option value=\"client_admin\"\r\n              i18n=\"@@topnav_editprofile_clientadmin\">\r\n            Client Administrator\r\n          </mat-option>\r\n          <mat-option value=\"super_user\"\r\n              i18n=\"@@topnav_editprofile_superuser\">\r\n            Superuser\r\n          </mat-option>\r\n          <mat-option value=\"user\"\r\n              i18n=\"@@topnav_editprofile_normaluser\">\r\n            Normal User\r\n          </mat-option>\r\n          <mat-option value=\"cust_user1\">\r\n            <span i18n=\"@@topnav_editprofile_customuser\">Custom User</span> 1\r\n          </mat-option>\r\n          <mat-option value=\"cust_user2\">\r\n            <span i18n=\"@@topnav_editprofile_customuser\">Custom User</span> 2\r\n          </mat-option>\r\n          <mat-option value=\"cust_user3\">\r\n            <span i18n=\"@@topnav_editprofile_customuser\">Custom User</span> 3\r\n          </mat-option>\r\n          <mat-option value=\"cust_user4\">\r\n            <span i18n=\"@@topnav_editprofile_customuser\">Custom User</span> 4\r\n          </mat-option>\r\n          <mat-option value=\"cust_user5\">\r\n            <span i18n=\"@@topnav_editprofile_customuser\">Custom User</span> 5\r\n          </mat-option>\r\n          <mat-option value=\"cust_user6\">\r\n            <span i18n=\"@@topnav_editprofile_customuser\">Custom User</span> 6\r\n          </mat-option>\r\n          <mat-option value=\"cust_user7\">\r\n            <span i18n=\"@@topnav_editprofile_customuser\">Custom User</span> 7\r\n          </mat-option>\r\n          <mat-option value=\"cust_user8\">\r\n            <span i18n=\"@@topnav_editprofile_customuser\">Custom User</span> 8\r\n          </mat-option>\r\n          <mat-option value=\"none_role\"\r\n              i18n=\"@@topnav_editprofile_role_none\">\r\n            None\r\n          </mat-option>\r\n        </mat-select>\r\n      </mat-form-field>\r\n\r\n    </div>\r\n    <div class=\"form-row\">\r\n      <mat-form-field appearance=\"outline\"\r\n          class=\"email\">\r\n        <mat-label i18n=\"@@topnav_editprofile_email\">Email</mat-label>\r\n        <input formControlName=\"email\"\r\n            matInput\r\n            type=\"email\"\r\n        >\r\n      </mat-form-field>\r\n    </div>\r\n    <div class=\"form-row\">\r\n      <mat-form-field appearance=\"outline\">\r\n        <mat-label i18n=\"@@topnav_editprofile_firstname\">First Name</mat-label>\r\n        <input formControlName=\"firstName\"\r\n            matInput\r\n            required>\r\n        <mat-error i18n=\"@@topnav_field_required\">This field is required</mat-error>\r\n      </mat-form-field>\r\n\r\n      <mat-form-field appearance=\"outline\">\r\n        <mat-label i18n=\"@@topnav_editprofile_lastname\">Last Name</mat-label>\r\n        <input formControlName=\"lastName\"\r\n            matInput\r\n            required>\r\n        <mat-error i18n=\"@@topnav_field_required\">This field is required</mat-error>\r\n      </mat-form-field>\r\n    </div>\r\n    <div class=\"form-row\">\r\n      <mat-form-field appearance=\"outline\">\r\n        <mat-label i18n=\"@@topnav_editprofile_language\">Language</mat-label>\r\n        <mat-select formControlName=\"locale\">\r\n          <mat-option *ngFor=\"let lang of languages$ | async\"\r\n              [value]=\"lang.id\">{{ lang.name }}</mat-option>\r\n        </mat-select>\r\n      </mat-form-field>\r\n\r\n      <mat-form-field appearance=\"outline\">\r\n        <mat-label i18n=\"@@topnav_editprofile_timezone\">Time Zone</mat-label>\r\n        <mat-select formControlName=\"timeZone\">\r\n          <mat-option *ngFor=\"let zone of timeZones$ | async\"\r\n              [value]=\"zone.id\">{{ zone.name }}</mat-option>\r\n        </mat-select>\r\n      </mat-form-field>\r\n    </div>\r\n    <div class=\"form-row toggle\">\r\n      <mat-slide-toggle formControlName=\"communication\"\r\n          labelPosition=\"after\"\r\n          i18n=\"@@topnav_editprofile_receive_emergency\">Receive emergency\r\n        communication\r\n      </mat-slide-toggle>\r\n    </div>\r\n    <div class=\"form-row toggle\"\r\n        *ngIf=\"displayMfaSetting\">\r\n      <mat-slide-toggle formControlName=\"mfaEnabled\"\r\n          labelPosition=\"after\"\r\n          i18n=\"@@topnav_editprofile_mfa\">Enable MFA for admin role\r\n      </mat-slide-toggle>\r\n    </div>\r\n    <div class=\"actions\">\r\n      <button (click)=\"saveUserProfile()\"\r\n          color=\"primary\"\r\n          mat-flat-button\r\n          type=\"button\"\r\n          i18n=\"@@topnav_savebtn\"\r\n      >Save\r\n      </button>\r\n    </div>\r\n  </form>\r\n</section>\r\n", styles: [".actions{margin-top:14px;text-align:right}.form-container{padding:14px 0;font-size:14px}.form-row{display:flex;flex-direction:row;justify-content:space-between;margin-bottom:5px}.form-row>.mat-mdc-form-field{width:47%}.form-row>.mat-mdc-form-field.email{width:100%}.toggle{margin-bottom:24px;padding-left:14px}\n"] }]
        }], ctorParameters: function () { return [{ type: i1.HttpClient }, { type: i2.UntypedFormBuilder }, { type: i0.ChangeDetectorRef }, { type: i3.NotificationService }]; }, propDecorators: { profileDataUrl: [{
                type: Input
            }], languageDataUrl: [{
                type: Input
            }], timeZoneDataUrl: [{
                type: Input
            }], profileSaveUrl: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZWRpdC1wcm9maWxlLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL21hcHAtdWkvY29tbW9uL3NyYy9saWIvdG9wLW5hdmlnYXRpb24vY29tcG9uZW50cy9lZGl0LXByb2ZpbGUvZWRpdC1wcm9maWxlLmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL21hcHAtdWkvY29tbW9uL3NyYy9saWIvdG9wLW5hdmlnYXRpb24vY29tcG9uZW50cy9lZGl0LXByb2ZpbGUvZWRpdC1wcm9maWxlLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBaUMsVUFBVSxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDakYsT0FBTyxFQUFFLHVCQUF1QixFQUFxQixTQUFTLEVBQUUsS0FBSyxFQUFVLE1BQU0sZUFBZSxDQUFDO0FBQ3JHLE9BQU8sRUFBd0MsVUFBVSxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFHbEYsT0FBTyxFQUFFLEdBQUcsRUFBRSxNQUFNLGdCQUFnQixDQUFDOzs7Ozs7Ozs7Ozs7QUFVckMsTUFBTSxPQUFPLG9CQUFvQjtJQW9CL0IsWUFDWSxJQUFnQixFQUNoQixFQUFzQixFQUN0QixFQUFxQixFQUNyQixFQUF1QjtRQUh2QixTQUFJLEdBQUosSUFBSSxDQUFZO1FBQ2hCLE9BQUUsR0FBRixFQUFFLENBQW9CO1FBQ3RCLE9BQUUsR0FBRixFQUFFLENBQW1CO1FBQ3JCLE9BQUUsR0FBRixFQUFFLENBQXFCO1FBTm5DLHNCQUFpQixHQUFHLEtBQUssQ0FBQztJQVExQixDQUFDO0lBRUQsUUFBUTtRQUNOLElBQUksQ0FBQyxVQUFVLEVBQUUsQ0FBQztRQUNsQixJQUFJLElBQUksQ0FBQyxjQUFjLEVBQUU7WUFDdkIsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQXFCLElBQUksQ0FBQyxjQUFjLENBQUM7aUJBQ2pELFNBQVMsQ0FBQyxHQUFHLENBQUMsRUFBRTtnQkFDZixJQUFJLENBQUMsV0FBVyxHQUFHLEdBQUcsQ0FBQztnQkFDdkIsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUM7b0JBQ2QsS0FBSyxFQUFFLElBQUksQ0FBQyxXQUFXLENBQUMsa0JBQWtCLENBQUM7b0JBQzNDLElBQUksRUFBRSxJQUFJLENBQUMsV0FBVyxDQUFDLHlCQUF5QixDQUFDO29CQUNqRCxRQUFRLEVBQUUsSUFBSSxDQUFDLFdBQVcsQ0FBQyxxQkFBcUIsQ0FBQztvQkFDakQsTUFBTSxFQUFFLElBQUksQ0FBQyxXQUFXLENBQUMsbUJBQW1CLENBQUM7b0JBQzdDLElBQUksRUFBRSxJQUFJLENBQUMsV0FBVyxDQUFDLGlCQUFpQixDQUFDO29CQUN6QyxhQUFhLEVBQUUsSUFBSSxDQUFDLFdBQVcsQ0FBQyxtQ0FBbUMsQ0FBQyxLQUFLLE1BQU07b0JBQy9FLFNBQVMsRUFBRSxJQUFJLENBQUMsV0FBVyxDQUFDLHNCQUFzQixDQUFDO29CQUNuRCxRQUFRLEVBQUUsSUFBSSxDQUFDLFdBQVcsQ0FBQyxxQkFBcUIsQ0FBQztvQkFDakQsVUFBVSxFQUFFLElBQUksQ0FBQyxXQUFXLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxNQUFNO2lCQUMxRCxDQUFDLENBQUM7Z0JBQ0gsSUFBSSxDQUFDLGlCQUFpQixHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsdUJBQXVCLENBQUMsS0FBSyxNQUFNLENBQUM7Z0JBQzlFLElBQUksQ0FBQyxFQUFFLENBQUMsWUFBWSxFQUFFLENBQUM7WUFDekIsQ0FBQyxDQUFDLENBQUM7U0FDUjtRQUVELElBQUksSUFBSSxDQUFDLGVBQWUsRUFBRTtZQUN4QixJQUFJLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFlLElBQUksQ0FBQyxlQUFlLENBQUM7aUJBQzlELElBQUksQ0FDRCxHQUFHLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsc0JBQXNCLENBQUMsQ0FDekMsQ0FBQztTQUNQO1FBRUQsSUFBSSxJQUFJLENBQUMsZUFBZSxFQUFFO1lBQ3hCLElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQWUsSUFBSSxDQUFDLGVBQWUsQ0FBQztpQkFDOUQsSUFBSSxDQUNELEdBQUcsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FDNUIsQ0FBQztTQUNQO0lBQ0gsQ0FBQztJQUVELGVBQWU7UUFDYixJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFO1lBQ3JCLE9BQU87U0FDUjtRQUVELE1BQU0sUUFBUSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDO1FBQ2pDLE1BQU0sT0FBTyxHQUEyQjtZQUN0QyxrQkFBa0IsRUFBRSxJQUFJLENBQUMsV0FBVyxDQUFDLGtCQUFrQixDQUFDO1lBQ3hELGVBQWUsRUFBRSxJQUFJLENBQUMsV0FBVyxDQUFDLGVBQWUsQ0FBQztZQUNsRCxpQkFBaUIsRUFBRSxJQUFJLENBQUMsV0FBVyxDQUFDLGlCQUFpQixDQUFDO1lBQ3RELHlCQUF5QixFQUFFLElBQUksQ0FBQyxXQUFXLENBQUMseUJBQXlCLENBQUM7WUFDdEUsbUJBQW1CLEVBQUUsUUFBUSxDQUFDLE1BQU07WUFDcEMscUJBQXFCLEVBQUUsUUFBUSxDQUFDLFFBQVE7WUFDeEMsc0JBQXNCLEVBQUUsUUFBUSxDQUFDLFNBQVM7WUFDMUMscUJBQXFCLEVBQUUsUUFBUSxDQUFDLFFBQVE7WUFDeEMsbUNBQW1DLEVBQUUsUUFBUSxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxLQUFLO1lBQzFFLE1BQU0sRUFBRSxnQkFBZ0I7WUFDeEIsU0FBUyxFQUFFLGtCQUFrQjtTQUM5QixDQUFDO1FBQ0YsSUFBSSxJQUFJLENBQUMsaUJBQWlCLEVBQUU7WUFDMUIsT0FBTyxDQUFDLHlCQUF5QixDQUFDLEdBQUcsUUFBUSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUM7U0FDekU7UUFFRCxNQUFNLElBQUksR0FBRyxJQUFJLFVBQVUsQ0FBQyxFQUFFLFVBQVUsRUFBRSxPQUFPLEVBQUUsQ0FBQyxDQUFDO1FBRXJELE1BQU0sZUFBZSxHQUFHLENBQUMsR0FBVyxFQUFFLEVBQUU7WUFDdEMsSUFBSSxHQUFHLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFO2dCQUNqQyxJQUFJLENBQUMsRUFBRSxDQUFDLGVBQWUsQ0FBQztvQkFDdEIsSUFBSSxFQUFFLE9BQU87b0JBQ2IsT0FBTyxFQUFFO3dCQUNQLFFBQVEsRUFBRSx3QkFBd0I7d0JBQ2xDLElBQUksRUFBRSxHQUFHO3dCQUNULFdBQVcsRUFBRSxJQUFJO3FCQUNsQjtpQkFDRixDQUFDLENBQUM7YUFDSjtpQkFBTTtnQkFDTCxJQUFJLENBQUMsRUFBRSxDQUFDLGVBQWUsQ0FBQztvQkFDdEIsSUFBSSxFQUFFLFNBQVM7b0JBQ2YsT0FBTyxFQUFFO3dCQUNQLFFBQVEsRUFBRSxrQkFBa0I7cUJBQzdCO2lCQUNGLENBQUMsQ0FBQzthQUNKO1FBQ0gsQ0FBQyxDQUFDO1FBRUYsSUFBSSxJQUFJLENBQUMsY0FBYyxFQUFFO1lBQ3ZCLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxjQUFjLEVBQUUsSUFBSSxFQUFFLEVBQUUsWUFBWSxFQUFFLE1BQU0sRUFBRSxDQUFDO2lCQUM5RCxTQUFTLENBQUM7Z0JBQ1QsSUFBSSxFQUFFLGVBQWU7Z0JBQ3JCLEtBQUssRUFBRSxDQUFDLEdBQXNCLEVBQUUsRUFBRTtvQkFDaEMsT0FBTyxDQUFDLEtBQUssQ0FBQyxzQ0FBc0MsRUFBRSxHQUFHLENBQUMsQ0FBQztnQkFDN0QsQ0FBQzthQUNGLENBQUMsQ0FBQztTQUNSO0lBRUgsQ0FBQztJQUVPLFVBQVU7UUFDaEIsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQztZQUN4QixLQUFLLEVBQUUsQ0FBQyxFQUFFLEtBQUssRUFBRSxFQUFFLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxDQUFDO1lBQ3RDLElBQUksRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLGVBQWUsRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFFLENBQUM7WUFDbEQsUUFBUSxFQUFFLEVBQUU7WUFDWixNQUFNLEVBQUUsRUFBRTtZQUNWLElBQUksRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFFLENBQUM7WUFDdEMsYUFBYSxFQUFFLEtBQUs7WUFDcEIsU0FBUyxFQUFFLENBQUMsRUFBRSxFQUFFLFVBQVUsQ0FBQyxRQUFRLENBQUM7WUFDcEMsUUFBUSxFQUFFLENBQUMsRUFBRSxFQUFFLFVBQVUsQ0FBQyxRQUFRLENBQUM7WUFDbkMsVUFBVSxFQUFFLEtBQUs7U0FDbEIsQ0FBQyxDQUFDO0lBQ0wsQ0FBQzs7a0hBdElVLG9CQUFvQjtzR0FBcEIsb0JBQW9CLGdOQ2ZqQyxrMUxBaUpBOzRGRGxJYSxvQkFBb0I7a0JBTmhDLFNBQVM7K0JBQ0Usa0JBQWtCLG1CQUdYLHVCQUF1QixDQUFDLE1BQU07b01BSy9DLGNBQWM7c0JBRGIsS0FBSztnQkFJTixlQUFlO3NCQURkLEtBQUs7Z0JBSU4sZUFBZTtzQkFEZCxLQUFLO2dCQUlOLGNBQWM7c0JBRGIsS0FBSyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEh0dHBDbGllbnQsIEh0dHBFcnJvclJlc3BvbnNlLCBIdHRwUGFyYW1zIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xyXG5pbXBvcnQgeyBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSwgQ2hhbmdlRGV0ZWN0b3JSZWYsIENvbXBvbmVudCwgSW5wdXQsIE9uSW5pdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBVbnR5cGVkRm9ybUJ1aWxkZXIsIFVudHlwZWRGb3JtR3JvdXAsIFZhbGlkYXRvcnMgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XHJcbmltcG9ydCB7IE5vdGlmaWNhdGlvblNlcnZpY2UgfSBmcm9tICdAbWFwcC11aS9ub3RpZmljYXRpb24tY2VudGVyJztcclxuaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyBtYXAgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XHJcbmltcG9ydCB7IExhbmd1YWdlRGF0YSwgTGFuZ3VhZ2VMaXN0LCBUaW1lWm9uZURhdGEsIFRpbWVab25lTGlzdCB9IGZyb20gJy4uLy4uL2NvcmUvbW9kZWxzL3Byb2ZpbGUtZGF0YSc7XHJcbmltcG9ydCB7IFVzZXJNZ210UHJvcGVydGllcyB9IGZyb20gJy4uLy4uL2NvcmUvbW9kZWxzL3VzZXItbWdtdC1wcm9wZXJ0aWVzJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAnbXVpLWVkaXQtcHJvZmlsZScsXHJcbiAgdGVtcGxhdGVVcmw6ICcuL2VkaXQtcHJvZmlsZS5jb21wb25lbnQuaHRtbCcsXHJcbiAgc3R5bGVVcmxzOiBbJy4vZWRpdC1wcm9maWxlLmNvbXBvbmVudC5zY3NzJ10sXHJcbiAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2hcclxufSlcclxuZXhwb3J0IGNsYXNzIEVkaXRQcm9maWxlQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcclxuXHJcbiAgQElucHV0KClcclxuICBwcm9maWxlRGF0YVVybDogc3RyaW5nO1xyXG5cclxuICBASW5wdXQoKVxyXG4gIGxhbmd1YWdlRGF0YVVybDogc3RyaW5nO1xyXG5cclxuICBASW5wdXQoKVxyXG4gIHRpbWVab25lRGF0YVVybDogc3RyaW5nO1xyXG5cclxuICBASW5wdXQoKVxyXG4gIHByb2ZpbGVTYXZlVXJsOiBzdHJpbmc7XHJcblxyXG4gIHByb2ZpbGVEYXRhOiBVc2VyTWdtdFByb3BlcnRpZXM7XHJcbiAgbGFuZ3VhZ2VzJDogT2JzZXJ2YWJsZTxMYW5ndWFnZURhdGFbXT47XHJcbiAgdGltZVpvbmVzJDogT2JzZXJ2YWJsZTxUaW1lWm9uZURhdGFbXT47XHJcbiAgZm9ybTogVW50eXBlZEZvcm1Hcm91cDtcclxuICBkaXNwbGF5TWZhU2V0dGluZyA9IGZhbHNlO1xyXG5cclxuICBjb25zdHJ1Y3RvcihcclxuICAgICAgcHJpdmF0ZSBodHRwOiBIdHRwQ2xpZW50LFxyXG4gICAgICBwcml2YXRlIGZiOiBVbnR5cGVkRm9ybUJ1aWxkZXIsXHJcbiAgICAgIHByaXZhdGUgY2Q6IENoYW5nZURldGVjdG9yUmVmLFxyXG4gICAgICBwcml2YXRlIG5jOiBOb3RpZmljYXRpb25TZXJ2aWNlXHJcbiAgKSB7XHJcbiAgfVxyXG5cclxuICBuZ09uSW5pdCgpOiB2b2lkIHtcclxuICAgIHRoaXMuY3JlYXRlRm9ybSgpO1xyXG4gICAgaWYgKHRoaXMucHJvZmlsZURhdGFVcmwpIHtcclxuICAgICAgdGhpcy5odHRwLmdldDxVc2VyTWdtdFByb3BlcnRpZXM+KHRoaXMucHJvZmlsZURhdGFVcmwpXHJcbiAgICAgICAgICAuc3Vic2NyaWJlKHJlcyA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMucHJvZmlsZURhdGEgPSByZXM7XHJcbiAgICAgICAgICAgIHRoaXMuZm9ybS5yZXNldCh7XHJcbiAgICAgICAgICAgICAgZW1haWw6IHRoaXMucHJvZmlsZURhdGFbJ3N5c3RlbVVzZXIuRW1haWwnXSxcclxuICAgICAgICAgICAgICByb2xlOiB0aGlzLnByb2ZpbGVEYXRhWydzeXN0ZW1Vc2VyLkN1c3RvbWVyUm9sZSddLFxyXG4gICAgICAgICAgICAgIHRpbWVab25lOiB0aGlzLnByb2ZpbGVEYXRhWydzeXN0ZW1Vc2VyLlRpbWVab25lJ10sXHJcbiAgICAgICAgICAgICAgbG9jYWxlOiB0aGlzLnByb2ZpbGVEYXRhWydzeXN0ZW1Vc2VyLkxvY2FsZSddLFxyXG4gICAgICAgICAgICAgIHR5cGU6IHRoaXMucHJvZmlsZURhdGFbJ3N5c3RlbVVzZXIuVHlwZSddLFxyXG4gICAgICAgICAgICAgIGNvbW11bmljYXRpb246IHRoaXMucHJvZmlsZURhdGFbJ3N5c3RlbVVzZXIuRW1lcmdlbmN5Q29tbXVuaWNhdGlvbiddID09PSAndHJ1ZScsXHJcbiAgICAgICAgICAgICAgZmlyc3ROYW1lOiB0aGlzLnByb2ZpbGVEYXRhWydzeXN0ZW1Vc2VyLkZpcnN0TmFtZSddLFxyXG4gICAgICAgICAgICAgIGxhc3ROYW1lOiB0aGlzLnByb2ZpbGVEYXRhWydzeXN0ZW1Vc2VyLkxhc3ROYW1lJ10sXHJcbiAgICAgICAgICAgICAgbWZhRW5hYmxlZDogdGhpcy5wcm9maWxlRGF0YVsnc3lzdGVtVXNlci5NRkEnXSA9PT0gJ3RydWUnXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLmRpc3BsYXlNZmFTZXR0aW5nID0gdGhpcy5wcm9maWxlRGF0YVsnc3lzdGVtVXNlci5DYW5WaWV3TUZBJ10gPT09ICd0cnVlJztcclxuICAgICAgICAgICAgdGhpcy5jZC5tYXJrRm9yQ2hlY2soKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICh0aGlzLmxhbmd1YWdlRGF0YVVybCkge1xyXG4gICAgICB0aGlzLmxhbmd1YWdlcyQgPSB0aGlzLmh0dHAuZ2V0PExhbmd1YWdlTGlzdD4odGhpcy5sYW5ndWFnZURhdGFVcmwpXHJcbiAgICAgICAgICAucGlwZShcclxuICAgICAgICAgICAgICBtYXAocmVzID0+IHJlcy5sYW5ndWFnZXdpdGhjb3VudHJ5c2VxKVxyXG4gICAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAodGhpcy50aW1lWm9uZURhdGFVcmwpIHtcclxuICAgICAgdGhpcy50aW1lWm9uZXMkID0gdGhpcy5odHRwLmdldDxUaW1lWm9uZUxpc3Q+KHRoaXMudGltZVpvbmVEYXRhVXJsKVxyXG4gICAgICAgICAgLnBpcGUoXHJcbiAgICAgICAgICAgICAgbWFwKHJlcyA9PiByZXMudGltZXpvbmVzKVxyXG4gICAgICAgICAgKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNhdmVVc2VyUHJvZmlsZSgpOiB2b2lkIHtcclxuICAgIGlmICh0aGlzLmZvcm0uaW52YWxpZCkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgZm9ybURhdGEgPSB0aGlzLmZvcm0udmFsdWU7XHJcbiAgICBjb25zdCByYXdCb2R5OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xyXG4gICAgICAnc3lzdGVtVXNlci5FbWFpbCc6IHRoaXMucHJvZmlsZURhdGFbJ3N5c3RlbVVzZXIuRW1haWwnXSxcclxuICAgICAgJ3N5c3RlbVVzZXIuUEsnOiB0aGlzLnByb2ZpbGVEYXRhWydzeXN0ZW1Vc2VyLlBLJ10sXHJcbiAgICAgICdzeXN0ZW1Vc2VyLlR5cGUnOiB0aGlzLnByb2ZpbGVEYXRhWydzeXN0ZW1Vc2VyLlR5cGUnXSxcclxuICAgICAgJ3N5c3RlbVVzZXIuQ3VzdG9tZXJSb2xlJzogdGhpcy5wcm9maWxlRGF0YVsnc3lzdGVtVXNlci5DdXN0b21lclJvbGUnXSxcclxuICAgICAgJ3N5c3RlbVVzZXIuTG9jYWxlJzogZm9ybURhdGEubG9jYWxlLFxyXG4gICAgICAnc3lzdGVtVXNlci5UaW1lWm9uZSc6IGZvcm1EYXRhLnRpbWVab25lLFxyXG4gICAgICAnc3lzdGVtVXNlci5GaXJzdE5hbWUnOiBmb3JtRGF0YS5maXJzdE5hbWUsXHJcbiAgICAgICdzeXN0ZW1Vc2VyLkxhc3ROYW1lJzogZm9ybURhdGEubGFzdE5hbWUsXHJcbiAgICAgICdzeXN0ZW1Vc2VyX2VtZXJnZW5jeUNvbW11bmljYXRpb24nOiBmb3JtRGF0YS5jb21tdW5pY2F0aW9uID8gJ29uJyA6ICdvZmYnLFxyXG4gICAgICBhY3Rpb246ICdzYXZlU3lzdGVtVXNlcicsXHJcbiAgICAgIGVycm9yUGFnZTogJy9pbmMvZWNFcnJvci5qc3AnXHJcbiAgICB9O1xyXG4gICAgaWYgKHRoaXMuZGlzcGxheU1mYVNldHRpbmcpIHtcclxuICAgICAgcmF3Qm9keVsnc3lzdGVtVXNlcl9tZmFBZG1pblJvbGUnXSA9IGZvcm1EYXRhLm1mYUVuYWJsZWQgPyAnb24nIDogJ29mZic7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgYm9keSA9IG5ldyBIdHRwUGFyYW1zKHsgZnJvbU9iamVjdDogcmF3Qm9keSB9KTtcclxuXHJcbiAgICBjb25zdCByZXNwb25zZUhhbmRsZXIgPSAocmVzOiBzdHJpbmcpID0+IHtcclxuICAgICAgaWYgKHJlcy5pbmRleE9mKCdlYy1lcnJvcnMnKSA+IC0xKSB7XHJcbiAgICAgICAgdGhpcy5uYy5hZGROb3RpZmljYXRpb24oe1xyXG4gICAgICAgICAgdHlwZTogJ0VSUk9SJyxcclxuICAgICAgICAgIG1lc3NhZ2U6IHtcclxuICAgICAgICAgICAgaGVhZGxpbmU6ICdQcm9maWxlIHVwZGF0ZSBmYWlsZWQuJyxcclxuICAgICAgICAgICAgYm9keTogcmVzLFxyXG4gICAgICAgICAgICBodG1sQ29udGVudDogdHJ1ZVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMubmMuYWRkTm90aWZpY2F0aW9uKHtcclxuICAgICAgICAgIHR5cGU6ICdTVUNDRVNTJyxcclxuICAgICAgICAgIG1lc3NhZ2U6IHtcclxuICAgICAgICAgICAgaGVhZGxpbmU6ICdQcm9maWxlIHVwZGF0ZWQuJ1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIGlmICh0aGlzLnByb2ZpbGVTYXZlVXJsKSB7XHJcbiAgICAgIHRoaXMuaHR0cC5wb3N0KHRoaXMucHJvZmlsZVNhdmVVcmwsIGJvZHksIHsgcmVzcG9uc2VUeXBlOiAndGV4dCcgfSlcclxuICAgICAgICAgIC5zdWJzY3JpYmUoe1xyXG4gICAgICAgICAgICBuZXh0OiByZXNwb25zZUhhbmRsZXIsXHJcbiAgICAgICAgICAgIGVycm9yOiAoZXJyOiBIdHRwRXJyb3JSZXNwb25zZSkgPT4ge1xyXG4gICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1VuZXhwZWN0ZWQgZXJyb3Igc2F2aW5nIHVzZXIgcHJvZmlsZScsIGVycik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICB9XHJcblxyXG4gIHByaXZhdGUgY3JlYXRlRm9ybSgpOiB2b2lkIHtcclxuICAgIHRoaXMuZm9ybSA9IHRoaXMuZmIuZ3JvdXAoe1xyXG4gICAgICBlbWFpbDogW3sgdmFsdWU6ICcnLCBkaXNhYmxlZDogdHJ1ZSB9XSxcclxuICAgICAgcm9sZTogW3sgdmFsdWU6ICdhZG1pbmlzdHJhdG9yJywgZGlzYWJsZWQ6IHRydWUgfV0sXHJcbiAgICAgIHRpbWVab25lOiAnJyxcclxuICAgICAgbG9jYWxlOiAnJyxcclxuICAgICAgdHlwZTogW3sgdmFsdWU6ICdoJywgZGlzYWJsZWQ6IHRydWUgfV0sXHJcbiAgICAgIGNvbW11bmljYXRpb246IGZhbHNlLFxyXG4gICAgICBmaXJzdE5hbWU6IFsnJywgVmFsaWRhdG9ycy5yZXF1aXJlZF0sXHJcbiAgICAgIGxhc3ROYW1lOiBbJycsIFZhbGlkYXRvcnMucmVxdWlyZWRdLFxyXG4gICAgICBtZmFFbmFibGVkOiBmYWxzZVxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsIjxzZWN0aW9uICpuZ0lmPVwicHJvZmlsZURhdGFcIlxyXG4gICAgY2xhc3M9XCJmb3JtLWNvbnRhaW5lclwiPlxyXG4gIDxmb3JtIFtmb3JtR3JvdXBdPVwiZm9ybVwiPlxyXG4gICAgPGRpdiBjbGFzcz1cImZvcm0tcm93XCI+XHJcbiAgICAgIDxtYXQtZm9ybS1maWVsZCBhcHBlYXJhbmNlPVwib3V0bGluZVwiPlxyXG4gICAgICAgIDxtYXQtbGFiZWwgaTE4bj1cIkBAdG9wbmF2X2VkaXRwcm9maWxlX2FjY291bnR0eXBlXCI+VHlwZTwvbWF0LWxhYmVsPlxyXG4gICAgICAgIDxtYXQtc2VsZWN0IGZvcm1Db250cm9sTmFtZT1cInR5cGVcIj5cclxuICAgICAgICAgIDxtYXQtb3B0aW9uIHZhbHVlPVwidVwiXHJcbiAgICAgICAgICAgICAgaTE4bj1cIkBAdG9wbmF2X2VkaXRwcm9maWxlX3VpdXNlclwiPlxyXG4gICAgICAgICAgICBVSSBVc2VyXHJcbiAgICAgICAgICA8L21hdC1vcHRpb24+XHJcbiAgICAgICAgICA8bWF0LW9wdGlvbiB2YWx1ZT1cImFcIlxyXG4gICAgICAgICAgICAgIGkxOG49XCJAQHRvcG5hdl9lZGl0cHJvZmlsZV9hcGl1c2VyXCI+XHJcbiAgICAgICAgICAgIEFQSSBVc2VyXHJcbiAgICAgICAgICA8L21hdC1vcHRpb24+XHJcbiAgICAgICAgICA8bWF0LW9wdGlvbiB2YWx1ZT1cImhcIlxyXG4gICAgICAgICAgICAgIGkxOG49XCJAQHRvcG5hdl9lZGl0cHJvZmlsZV9oeWJyaWR1c2VyXCI+XHJcbiAgICAgICAgICAgIEh5YnJpZCBVc2VyXHJcbiAgICAgICAgICA8L21hdC1vcHRpb24+XHJcbiAgICAgICAgPC9tYXQtc2VsZWN0PlxyXG4gICAgICA8L21hdC1mb3JtLWZpZWxkPlxyXG4gICAgICA8bWF0LWZvcm0tZmllbGQgYXBwZWFyYW5jZT1cIm91dGxpbmVcIj5cclxuICAgICAgICA8bWF0LWxhYmVsIGkxOG49XCJAQHRvcG5hdl9lZGl0cHJvZmlsZV9yb2xlXCI+Um9sZTwvbWF0LWxhYmVsPlxyXG4gICAgICAgIDxtYXQtc2VsZWN0IGZvcm1Db250cm9sTmFtZT1cInJvbGVcIj5cclxuICAgICAgICAgIDxtYXQtb3B0aW9uIHZhbHVlPVwiYWRtaW5pc3RyYXRvclwiXHJcbiAgICAgICAgICAgICAgaTE4bj1cIkBAdG9wbmF2X2VkaXRwcm9maWxlX2FkbWluXCI+XHJcbiAgICAgICAgICAgIEFkbWluaXN0cmF0b3JcclxuICAgICAgICAgIDwvbWF0LW9wdGlvbj5cclxuICAgICAgICAgIDxtYXQtb3B0aW9uIHZhbHVlPVwicHJvamVjdF9tYW5hZ2VyXCJcclxuICAgICAgICAgICAgICBpMThuPVwiQEB0b3BuYXZfZWRpdHByb2ZpbGVfcG1cIj5cclxuICAgICAgICAgICAgUHJvamVjdCBNYW5hZ2VyXHJcbiAgICAgICAgICA8L21hdC1vcHRpb24+XHJcbiAgICAgICAgICA8bWF0LW9wdGlvbiB2YWx1ZT1cImNsaWVudF9hZG1pblwiXHJcbiAgICAgICAgICAgICAgaTE4bj1cIkBAdG9wbmF2X2VkaXRwcm9maWxlX2NsaWVudGFkbWluXCI+XHJcbiAgICAgICAgICAgIENsaWVudCBBZG1pbmlzdHJhdG9yXHJcbiAgICAgICAgICA8L21hdC1vcHRpb24+XHJcbiAgICAgICAgICA8bWF0LW9wdGlvbiB2YWx1ZT1cInN1cGVyX3VzZXJcIlxyXG4gICAgICAgICAgICAgIGkxOG49XCJAQHRvcG5hdl9lZGl0cHJvZmlsZV9zdXBlcnVzZXJcIj5cclxuICAgICAgICAgICAgU3VwZXJ1c2VyXHJcbiAgICAgICAgICA8L21hdC1vcHRpb24+XHJcbiAgICAgICAgICA8bWF0LW9wdGlvbiB2YWx1ZT1cInVzZXJcIlxyXG4gICAgICAgICAgICAgIGkxOG49XCJAQHRvcG5hdl9lZGl0cHJvZmlsZV9ub3JtYWx1c2VyXCI+XHJcbiAgICAgICAgICAgIE5vcm1hbCBVc2VyXHJcbiAgICAgICAgICA8L21hdC1vcHRpb24+XHJcbiAgICAgICAgICA8bWF0LW9wdGlvbiB2YWx1ZT1cImN1c3RfdXNlcjFcIj5cclxuICAgICAgICAgICAgPHNwYW4gaTE4bj1cIkBAdG9wbmF2X2VkaXRwcm9maWxlX2N1c3RvbXVzZXJcIj5DdXN0b20gVXNlcjwvc3Bhbj4gMVxyXG4gICAgICAgICAgPC9tYXQtb3B0aW9uPlxyXG4gICAgICAgICAgPG1hdC1vcHRpb24gdmFsdWU9XCJjdXN0X3VzZXIyXCI+XHJcbiAgICAgICAgICAgIDxzcGFuIGkxOG49XCJAQHRvcG5hdl9lZGl0cHJvZmlsZV9jdXN0b211c2VyXCI+Q3VzdG9tIFVzZXI8L3NwYW4+IDJcclxuICAgICAgICAgIDwvbWF0LW9wdGlvbj5cclxuICAgICAgICAgIDxtYXQtb3B0aW9uIHZhbHVlPVwiY3VzdF91c2VyM1wiPlxyXG4gICAgICAgICAgICA8c3BhbiBpMThuPVwiQEB0b3BuYXZfZWRpdHByb2ZpbGVfY3VzdG9tdXNlclwiPkN1c3RvbSBVc2VyPC9zcGFuPiAzXHJcbiAgICAgICAgICA8L21hdC1vcHRpb24+XHJcbiAgICAgICAgICA8bWF0LW9wdGlvbiB2YWx1ZT1cImN1c3RfdXNlcjRcIj5cclxuICAgICAgICAgICAgPHNwYW4gaTE4bj1cIkBAdG9wbmF2X2VkaXRwcm9maWxlX2N1c3RvbXVzZXJcIj5DdXN0b20gVXNlcjwvc3Bhbj4gNFxyXG4gICAgICAgICAgPC9tYXQtb3B0aW9uPlxyXG4gICAgICAgICAgPG1hdC1vcHRpb24gdmFsdWU9XCJjdXN0X3VzZXI1XCI+XHJcbiAgICAgICAgICAgIDxzcGFuIGkxOG49XCJAQHRvcG5hdl9lZGl0cHJvZmlsZV9jdXN0b211c2VyXCI+Q3VzdG9tIFVzZXI8L3NwYW4+IDVcclxuICAgICAgICAgIDwvbWF0LW9wdGlvbj5cclxuICAgICAgICAgIDxtYXQtb3B0aW9uIHZhbHVlPVwiY3VzdF91c2VyNlwiPlxyXG4gICAgICAgICAgICA8c3BhbiBpMThuPVwiQEB0b3BuYXZfZWRpdHByb2ZpbGVfY3VzdG9tdXNlclwiPkN1c3RvbSBVc2VyPC9zcGFuPiA2XHJcbiAgICAgICAgICA8L21hdC1vcHRpb24+XHJcbiAgICAgICAgICA8bWF0LW9wdGlvbiB2YWx1ZT1cImN1c3RfdXNlcjdcIj5cclxuICAgICAgICAgICAgPHNwYW4gaTE4bj1cIkBAdG9wbmF2X2VkaXRwcm9maWxlX2N1c3RvbXVzZXJcIj5DdXN0b20gVXNlcjwvc3Bhbj4gN1xyXG4gICAgICAgICAgPC9tYXQtb3B0aW9uPlxyXG4gICAgICAgICAgPG1hdC1vcHRpb24gdmFsdWU9XCJjdXN0X3VzZXI4XCI+XHJcbiAgICAgICAgICAgIDxzcGFuIGkxOG49XCJAQHRvcG5hdl9lZGl0cHJvZmlsZV9jdXN0b211c2VyXCI+Q3VzdG9tIFVzZXI8L3NwYW4+IDhcclxuICAgICAgICAgIDwvbWF0LW9wdGlvbj5cclxuICAgICAgICAgIDxtYXQtb3B0aW9uIHZhbHVlPVwibm9uZV9yb2xlXCJcclxuICAgICAgICAgICAgICBpMThuPVwiQEB0b3BuYXZfZWRpdHByb2ZpbGVfcm9sZV9ub25lXCI+XHJcbiAgICAgICAgICAgIE5vbmVcclxuICAgICAgICAgIDwvbWF0LW9wdGlvbj5cclxuICAgICAgICA8L21hdC1zZWxlY3Q+XHJcbiAgICAgIDwvbWF0LWZvcm0tZmllbGQ+XHJcblxyXG4gICAgPC9kaXY+XHJcbiAgICA8ZGl2IGNsYXNzPVwiZm9ybS1yb3dcIj5cclxuICAgICAgPG1hdC1mb3JtLWZpZWxkIGFwcGVhcmFuY2U9XCJvdXRsaW5lXCJcclxuICAgICAgICAgIGNsYXNzPVwiZW1haWxcIj5cclxuICAgICAgICA8bWF0LWxhYmVsIGkxOG49XCJAQHRvcG5hdl9lZGl0cHJvZmlsZV9lbWFpbFwiPkVtYWlsPC9tYXQtbGFiZWw+XHJcbiAgICAgICAgPGlucHV0IGZvcm1Db250cm9sTmFtZT1cImVtYWlsXCJcclxuICAgICAgICAgICAgbWF0SW5wdXRcclxuICAgICAgICAgICAgdHlwZT1cImVtYWlsXCJcclxuICAgICAgICA+XHJcbiAgICAgIDwvbWF0LWZvcm0tZmllbGQ+XHJcbiAgICA8L2Rpdj5cclxuICAgIDxkaXYgY2xhc3M9XCJmb3JtLXJvd1wiPlxyXG4gICAgICA8bWF0LWZvcm0tZmllbGQgYXBwZWFyYW5jZT1cIm91dGxpbmVcIj5cclxuICAgICAgICA8bWF0LWxhYmVsIGkxOG49XCJAQHRvcG5hdl9lZGl0cHJvZmlsZV9maXJzdG5hbWVcIj5GaXJzdCBOYW1lPC9tYXQtbGFiZWw+XHJcbiAgICAgICAgPGlucHV0IGZvcm1Db250cm9sTmFtZT1cImZpcnN0TmFtZVwiXHJcbiAgICAgICAgICAgIG1hdElucHV0XHJcbiAgICAgICAgICAgIHJlcXVpcmVkPlxyXG4gICAgICAgIDxtYXQtZXJyb3IgaTE4bj1cIkBAdG9wbmF2X2ZpZWxkX3JlcXVpcmVkXCI+VGhpcyBmaWVsZCBpcyByZXF1aXJlZDwvbWF0LWVycm9yPlxyXG4gICAgICA8L21hdC1mb3JtLWZpZWxkPlxyXG5cclxuICAgICAgPG1hdC1mb3JtLWZpZWxkIGFwcGVhcmFuY2U9XCJvdXRsaW5lXCI+XHJcbiAgICAgICAgPG1hdC1sYWJlbCBpMThuPVwiQEB0b3BuYXZfZWRpdHByb2ZpbGVfbGFzdG5hbWVcIj5MYXN0IE5hbWU8L21hdC1sYWJlbD5cclxuICAgICAgICA8aW5wdXQgZm9ybUNvbnRyb2xOYW1lPVwibGFzdE5hbWVcIlxyXG4gICAgICAgICAgICBtYXRJbnB1dFxyXG4gICAgICAgICAgICByZXF1aXJlZD5cclxuICAgICAgICA8bWF0LWVycm9yIGkxOG49XCJAQHRvcG5hdl9maWVsZF9yZXF1aXJlZFwiPlRoaXMgZmllbGQgaXMgcmVxdWlyZWQ8L21hdC1lcnJvcj5cclxuICAgICAgPC9tYXQtZm9ybS1maWVsZD5cclxuICAgIDwvZGl2PlxyXG4gICAgPGRpdiBjbGFzcz1cImZvcm0tcm93XCI+XHJcbiAgICAgIDxtYXQtZm9ybS1maWVsZCBhcHBlYXJhbmNlPVwib3V0bGluZVwiPlxyXG4gICAgICAgIDxtYXQtbGFiZWwgaTE4bj1cIkBAdG9wbmF2X2VkaXRwcm9maWxlX2xhbmd1YWdlXCI+TGFuZ3VhZ2U8L21hdC1sYWJlbD5cclxuICAgICAgICA8bWF0LXNlbGVjdCBmb3JtQ29udHJvbE5hbWU9XCJsb2NhbGVcIj5cclxuICAgICAgICAgIDxtYXQtb3B0aW9uICpuZ0Zvcj1cImxldCBsYW5nIG9mIGxhbmd1YWdlcyQgfCBhc3luY1wiXHJcbiAgICAgICAgICAgICAgW3ZhbHVlXT1cImxhbmcuaWRcIj57eyBsYW5nLm5hbWUgfX08L21hdC1vcHRpb24+XHJcbiAgICAgICAgPC9tYXQtc2VsZWN0PlxyXG4gICAgICA8L21hdC1mb3JtLWZpZWxkPlxyXG5cclxuICAgICAgPG1hdC1mb3JtLWZpZWxkIGFwcGVhcmFuY2U9XCJvdXRsaW5lXCI+XHJcbiAgICAgICAgPG1hdC1sYWJlbCBpMThuPVwiQEB0b3BuYXZfZWRpdHByb2ZpbGVfdGltZXpvbmVcIj5UaW1lIFpvbmU8L21hdC1sYWJlbD5cclxuICAgICAgICA8bWF0LXNlbGVjdCBmb3JtQ29udHJvbE5hbWU9XCJ0aW1lWm9uZVwiPlxyXG4gICAgICAgICAgPG1hdC1vcHRpb24gKm5nRm9yPVwibGV0IHpvbmUgb2YgdGltZVpvbmVzJCB8IGFzeW5jXCJcclxuICAgICAgICAgICAgICBbdmFsdWVdPVwiem9uZS5pZFwiPnt7IHpvbmUubmFtZSB9fTwvbWF0LW9wdGlvbj5cclxuICAgICAgICA8L21hdC1zZWxlY3Q+XHJcbiAgICAgIDwvbWF0LWZvcm0tZmllbGQ+XHJcbiAgICA8L2Rpdj5cclxuICAgIDxkaXYgY2xhc3M9XCJmb3JtLXJvdyB0b2dnbGVcIj5cclxuICAgICAgPG1hdC1zbGlkZS10b2dnbGUgZm9ybUNvbnRyb2xOYW1lPVwiY29tbXVuaWNhdGlvblwiXHJcbiAgICAgICAgICBsYWJlbFBvc2l0aW9uPVwiYWZ0ZXJcIlxyXG4gICAgICAgICAgaTE4bj1cIkBAdG9wbmF2X2VkaXRwcm9maWxlX3JlY2VpdmVfZW1lcmdlbmN5XCI+UmVjZWl2ZSBlbWVyZ2VuY3lcclxuICAgICAgICBjb21tdW5pY2F0aW9uXHJcbiAgICAgIDwvbWF0LXNsaWRlLXRvZ2dsZT5cclxuICAgIDwvZGl2PlxyXG4gICAgPGRpdiBjbGFzcz1cImZvcm0tcm93IHRvZ2dsZVwiXHJcbiAgICAgICAgKm5nSWY9XCJkaXNwbGF5TWZhU2V0dGluZ1wiPlxyXG4gICAgICA8bWF0LXNsaWRlLXRvZ2dsZSBmb3JtQ29udHJvbE5hbWU9XCJtZmFFbmFibGVkXCJcclxuICAgICAgICAgIGxhYmVsUG9zaXRpb249XCJhZnRlclwiXHJcbiAgICAgICAgICBpMThuPVwiQEB0b3BuYXZfZWRpdHByb2ZpbGVfbWZhXCI+RW5hYmxlIE1GQSBmb3IgYWRtaW4gcm9sZVxyXG4gICAgICA8L21hdC1zbGlkZS10b2dnbGU+XHJcbiAgICA8L2Rpdj5cclxuICAgIDxkaXYgY2xhc3M9XCJhY3Rpb25zXCI+XHJcbiAgICAgIDxidXR0b24gKGNsaWNrKT1cInNhdmVVc2VyUHJvZmlsZSgpXCJcclxuICAgICAgICAgIGNvbG9yPVwicHJpbWFyeVwiXHJcbiAgICAgICAgICBtYXQtZmxhdC1idXR0b25cclxuICAgICAgICAgIHR5cGU9XCJidXR0b25cIlxyXG4gICAgICAgICAgaTE4bj1cIkBAdG9wbmF2X3NhdmVidG5cIlxyXG4gICAgICA+U2F2ZVxyXG4gICAgICA8L2J1dHRvbj5cclxuICAgIDwvZGl2PlxyXG4gIDwvZm9ybT5cclxuPC9zZWN0aW9uPlxyXG4iXX0=